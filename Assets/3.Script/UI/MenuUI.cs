using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;

public class MenuUI : MonoBehaviour
{
    private enum Menu
    {
        Map,
        Quest,
        Item,
        Weapon,
        Skill,
        Data,
        System
    }

    // 몇번메뉴인지 확인하기위함 
    private int MenuCount = 0;

    // 인풋값 확인하기위한 불값
    private bool OpenMenu = false;
    private bool EnterMenuItem = false;

    //탑메뉴 색상
    private Color Select_Color = new Color(65f / 255f, 61f / 255f, 53f / 255f);
    private Color Default_Color = new Color(167f / 255f, 160f / 255f, 134f / 255f);
    private Color Select_Text_Color = new Color(157f / 255f, 153f / 255f, 139 / 255f);
    private Color Default_Text_Color = new Color(87f / 255f, 82f / 255f, 65 / 255f);
    //온오프할 메뉴들
    [Header("오브젝트를 넣어주세용")]
    [SerializeField] private GameObject MenuUI_ob;
    [Tooltip("미구현 Obj")]
    [SerializeField] private GameObject CanNot_ob;
    [Tooltip("하단 메뉴들")]
    [SerializeField] private GameObject[] BottomMenu;
    [Tooltip("상단 메뉴 이미지")]
    [SerializeField] private Image[] TopImage;
    [Tooltip("상단 메뉴 텍스트")]
    [SerializeField] private Text[] TopText;
    [Tooltip("상단 메뉴 마우스 커서")]
    [SerializeField] private Image Cursor;

    //마우스 커서 위치용 변수
    private Vector3 Defalut_TopMenu_Cursor = new Vector3(-860, 390, 0);
    private Vector3 Move_TopMenu_Cursor = new Vector3(250, 0, 0);
    private void Update()
    {
        if (Input.GetKeyDown(KeyCode.Escape)) //메뉴창 열기
        {
            if (OpenMenu)
            {
                MenuClose();
            }
            else
            {
                MenuOpen();
            }

        }
        if (OpenMenu && !EnterMenuItem) // 인벤토리가 열렸을 때 탑메뉴창 조작
        {

            if (MenuCount < 6) //우측화살표 클릭시 오른쪽 넘어가게
            {
                if (Input.GetKeyDown(KeyCode.RightArrow))
                {
                    RightArrow();
                }
            }
            if (MenuCount >= 1) //좌측 화살표 클릭시 왼쪽 넘어가게
            {
                if (Input.GetKeyDown(KeyCode.LeftArrow))
                {
                    LeftArrow();
                }
            }
            if (Input.GetKeyDown(KeyCode.KeypadEnter))
            {
                if (MenuCount != 2) //아이템 이외엔 미구현
                {
                    StartCoroutine(CantPlay());
                }
                else  //아이템에서 엔터클릭시 진행 
                {
                    EnterItem();
                }
            }
        }
        if (EnterMenuItem) //아이템 메뉴창에서 조작
        {
            if (Input.GetKeyDown(KeyCode.Escape))
            {
                ExitItem();
            }
            if (Input.GetKeyDown(KeyCode.UpArrow))
            {
                ItemUpArrow();
            }
            if (Input.GetKeyDown(KeyCode.DownArrow))
            {
                ItemDownArrow();

            }
            if (Input.GetKeyDown(KeyCode.KeypadEnter))
            {
                ItemEnter();
            }
        }
    }
    public void MenuOpen() //메뉴창 열기
    {
        MenuCount = 0;
        Time.timeScale = 0;
        OpenMenu = true;
        MenuUI_ob.SetActive(true);
        UpdateMenuUI();
        Cursor.gameObject.transform.localPosition = Defalut_TopMenu_Cursor;
    }
    public void MenuClose() //메뉴창 닫기
    {
        MenuCount = 0;
        Time.timeScale = 1;
        OpenMenu = false;
        MenuUI_ob.SetActive(false);
        for (int i=0; i<BottomMenu.Length; i++)
        {
            BottomMenu[i].SetActive(false);
        }
        
    }
    public void LeftArrow() //탑메뉴창 왼쪽 넘기기
    {
        MenuCount--;
        UpdateMenuUI();
        Cursor.transform.position -= Move_TopMenu_Cursor;
    }
    public void RightArrow() //탑메뉴창 오른쪽넘기기
    {
        MenuCount++;
        UpdateMenuUI();
        Cursor  .transform.position += Move_TopMenu_Cursor;
    }
    public void EnterItem() // 탑메뉴창에서 아이템으로 넘어가기
    {
        EnterMenuItem = true;

    }
    public void ExitItem() // 탑메뉴창으로 돌아가기
    {
        EnterMenuItem = false;
        
    }
   
    private void UpdateMenuUI() // 메뉴들 UI 업데이트 
    {
        Debug.Log(MenuCount);
        for (int i = 0; i < BottomMenu.Length; i++)
        {
            BottomMenu[i].SetActive(false);
            TopImage[i].color = Default_Color;
            TopText[i].color = Default_Text_Color;
        }
        BottomMenu[MenuCount].SetActive(true);
        TopImage[MenuCount].color = Select_Color;
        TopText[MenuCount].color = Select_Text_Color;

    }
    public void ItemUpArrow() //아이템 메뉴 위화살표 클릭시
    {

    }
    public void ItemDownArrow() //아이템 메뉴 아래화살표 클릭시
    {

    }
    public void ItemEnter() //아이템 메뉴 엔터클릭시 아이템 사용
    {

    }
    private IEnumerator CantPlay() //아이템 이외엔 미구현입니다 뜨는거
    {
        CanNot_ob.SetActive(true);
        yield return new WaitForSeconds(2f);
        CanNot_ob.SetActive(false);
    }
}
